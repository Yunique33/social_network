.comment
  %p= comment.body
  %small
    Commented by #{comment.user.email} at #{comment.created_at.strftime('%B %d, %Y %H:%M')}
  - if user_signed_in? && current_user == comment.user
    = link_to 'Delete', [comment.post, comment], method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-sm btn-danger'
  - if user_signed_in?
    = link_to 'Reply', '#', class: 'reply-link', data: { comment_id: comment.id }

  .reply-form{id: "reply-form-#{comment.id}", style: 'display: none;'}
    = form_with(model: [comment.post, Comment.new], local: true) do |form|
      = form.hidden_field :parent_id, value: comment.id
      = form.text_area :body, rows: 3, class: 'form-control'
      = form.submit 'Reply', class: 'btn btn-primary'

  - if comment.replies.any?
    .replies
      = render comment.replies
